import{a as h,r as n,f as x,j as e,s as u}from"./index-DLOQmAiS.js";import{M as g}from"./MovieGrid-BYeTr3fp.js";import{M as p}from"./MovieGridSkeleton-BIC0evs_.js";import"./useWatchLater-9hxFhDiQ.js";import"./MovieCardSkeleton-B2tHPRXo.js";const v=async()=>{let r=[],t=0;const o=1e3;for(;;){const{data:l,error:s,count:c}=await u.from("movies").select("*",{count:"exact"}).range(t,t+o-1);if(s)throw console.error("Error fetching all movies for search:",s),s;if(l){if(r=r.concat(l),r.length>=(c??0)||l.length<o)break;t+=o}else break}return r},S=()=>{const[r]=h(),t=r.get("q")||"",[o,l]=n.useState([]),[s,c]=n.useState([]),[i,d]=n.useState(!0);return n.useEffect(()=>{(async()=>{d(!0);try{const a=await v();l(a)}catch(a){console.error("Error fetching movies for search page:",a)}finally{d(!1)}})()},[]),n.useEffect(()=>{if(!i&&t){const m=o.filter(a=>x(t,a.title));m.sort((a,f)=>new Date(f.created_at).getTime()-new Date(a.created_at).getTime()),c(m)}else c([]);window.scrollTo(0,0)},[t,o,i]),i?e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8",children:['جاري البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"']}),e.jsx(p,{count:12})]}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8 border-r-4 border-cyan-400 pr-4",children:['نتائج البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"',e.jsxs("span",{className:"text-lg font-normal text-slate-400 mr-2",children:["(",s.length," نتيجة)"]})]}),s.length>0?e.jsx(g,{movies:s}):e.jsxs("div",{className:"text-center p-12 bg-slate-800/50 rounded-lg mt-8",children:[e.jsx("p",{className:"text-2xl text-slate-300 mb-4",children:"لا توجد أفلام تطابق بحثك."}),e.jsx("p",{className:"text-slate-400",children:"حاول استخدام كلمات رئيسية مختلفة."})]})]})};export{S as default};
