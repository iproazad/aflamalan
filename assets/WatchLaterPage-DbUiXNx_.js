import{r as s,j as e,L as M,d as j}from"./index-BiMpKAyZ.js";import{a as y}from"./MovieCardSkeleton-CVHw-g3d.js";import{M as P,a as w}from"./MovieGridSkeleton-Cf5YA0MP.js";import{P as E}from"./Pagination-DrWNvenw.js";const l=28,A=()=>{const[r,i]=s.useState([]),[p,n]=s.useState(!0),{watchLater:o}=y(),[c,d]=s.useState(1);s.useEffect(()=>{(async()=>{if(o.length===0){i([]),n(!1);return}n(!0);try{const x=[];for(let t=0;t<o.length;t+=30)x.push(o.slice(t,t+30));const v=x.map(t=>j.collection("movies").where(window.firebase.firestore.FieldPath.documentId(),"in",t).get()),f=(await Promise.all(v)).flatMap(t=>t.docs.map(a=>({id:a.id,...a.data()})));f.sort((t,a)=>{var g,u;return(g=t.createdAt)!=null&&g.toMillis&&((u=a.createdAt)!=null&&u.toMillis)?a.createdAt.toMillis()-t.createdAt.toMillis():0}),i(f)}catch(m){console.error("Error fetching watch later movies: ",m),i([])}finally{n(!1)}})()},[o]),s.useEffect(()=>{d(1)},[r]);const h=Math.ceil(r.length/l),b=r.slice((c-1)*l,c*l);return p?e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h1",{className:"text-4xl font-black text-white mb-8 border-r-4 border-cyan-400 pr-4",children:"قائمة المشاهدة لاحقاً"}),e.jsx(P,{count:18})]}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h1",{className:"text-4xl font-black text-white mb-8 border-r-4 border-cyan-400 pr-4",children:"قائمة المشاهدة لاحقاً"}),r.length>0?e.jsxs(e.Fragment,{children:[e.jsx(w,{movies:b}),h>1&&e.jsx(E,{currentPage:c,totalPages:h,onPageChange:d})]}):e.jsxs("div",{className:"text-center p-12 bg-gray-800/50 rounded-lg mt-8",children:[e.jsx("p",{className:"text-2xl text-gray-300 mb-4",children:"قائمة المشاهدة لاحقاً فارغة."}),e.jsx("p",{className:"text-gray-400 mb-6",children:"أضف أفلامًا لمشاهدتها لاحقًا بالنقر على أيقونة الإشارة المرجعية."}),e.jsx(M,{to:"/",className:"inline-block bg-cyan-500 text-white font-bold px-6 py-3 rounded-lg hover:bg-cyan-600 transition-colors",children:"تصفح الأفلام"})]})]})};export{A as default};
