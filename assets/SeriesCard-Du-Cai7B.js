import{u as g,r as l,d as h,F as m,R as f,j as t,L as v}from"./index-kFYueowS.js";const L=()=>{const{currentUser:e}=g(),[a,i]=l.useState([]);l.useEffect(()=>{if(!e){i([]);return}const n=h.collection("user_lists").doc(e.uid).onSnapshot(r=>{if(r.exists){const o=r.data();i((o==null?void 0:o.favoriteSeries)||[])}else i([])},r=>{console.error("Error listening to favorite series:",r)});return()=>n()},[e]);const c=l.useCallback(async s=>{if(!e){console.warn("User must be logged in to manage favorite series.");return}const n=h.collection("user_lists").doc(e.uid),r=a.includes(s);try{r?await n.update({favoriteSeries:m.arrayRemove(s)}):await n.set({favoriteSeries:m.arrayUnion(s)},{merge:!0})}catch(o){console.error("Error toggling favorite series in Firestore:",o)}},[e,a]),u=l.useCallback(s=>a.includes(s),[a]);return{favoriteSeries:a,toggleFavoriteSeries:c,isFavoriteSeries:u}},S=()=>{const{currentUser:e}=g(),[a,i]=l.useState([]);l.useEffect(()=>{if(!e){i([]);return}const n=h.collection("user_lists").doc(e.uid).onSnapshot(r=>{if(r.exists){const o=r.data();i((o==null?void 0:o.watchLaterSeries)||[])}else i([])},r=>{console.error("Error listening to watch later series list:",r)});return()=>n()},[e]);const c=l.useCallback(async s=>{if(!e){console.warn("User must be logged in to manage watch later list.");return}const n=h.collection("user_lists").doc(e.uid),r=a.includes(s);try{r?await n.update({watchLaterSeries:m.arrayRemove(s)}):await n.set({watchLaterSeries:m.arrayUnion(s)},{merge:!0})}catch(o){console.error("Error toggling watch later series in Firestore:",o)}},[e,a]),u=l.useCallback(s=>a.includes(s),[a]);return{watchLaterSeries:a,toggleWatchLaterSeries:c,isWatchLaterSeries:u}},b=({isFavorite:e})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 sm:h-6 sm:w-6 transition-all duration-300 ${e?"text-red-500":"text-white"}`,fill:e?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 016.364 0L12 7.636l1.318-1.318a4.5 4.5 0 016.364 6.364L12 20.364l-7.682-7.682a4.5 4.5 0 010-6.364z"})}),p=({isWatchLater:e})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 sm:h-6 sm:w-6 transition-all duration-300 ${e?"text-cyan-400":"text-white"}`,fill:e?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),w=({series:e,isFavorite:a,isWatchLater:i,onToggleFavorite:c,onToggleWatchLater:u})=>{const{currentUser:s}=g(),[n,r]=l.useState(!1),o=d=>{d.preventDefault(),d.stopPropagation(),c(e.id)},x=d=>{d.preventDefault(),d.stopPropagation(),u(e.id)};return t.jsx("div",{className:"relative group",children:t.jsxs(v,{to:`/series/${e.id}`,className:"relative block z-10 rounded-lg overflow-hidden shadow-lg hover:shadow-xl hover:shadow-cyan-500/20 transform transition-all duration-300 ease-in-out group-hover:scale-105 bg-slate-800",children:[s&&t.jsxs("div",{className:"absolute top-1.5 right-1.5 z-20 flex flex-col gap-1.5 opacity-0 group-hover:opacity-100 translate-y-2 group-hover:translate-y-0 transition-all duration-300",children:[t.jsx("button",{onClick:o,className:"p-1.5 bg-slate-900/60 rounded-full hover:bg-slate-900/80 transition-all duration-200 hover:scale-110","aria-label":a?"إزالة من المفضلة":"إضافة إلى المفضلة",children:t.jsx(b,{isFavorite:a})}),t.jsx("button",{onClick:x,className:"p-1.5 bg-slate-900/60 rounded-full hover:bg-slate-900/80 transition-all duration-200 hover:scale-110","aria-label":i?"إزالة من قائمة المشاهدة لاحقاً":"إضافة إلى قائمة المشاهدة لاحقاً",children:t.jsx(p,{isWatchLater:i})})]}),t.jsx("div",{className:"relative w-full aspect-[2/3] bg-slate-800 overflow-hidden",children:t.jsx("img",{src:e.posterUrl,loading:"lazy",onLoad:()=>r(!0),alt:e.title,className:`
              w-full h-full object-cover
              transition-all duration-700 ease-in-out group-hover:opacity-75
              ${n?"scale-100 blur-0":"scale-110 blur-md"}
            `})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/70 to-transparent"}),t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 sm:p-3 md:p-4 transition-all duration-300 group-hover:-translate-y-1",children:[t.jsx("h3",{className:"text-white text-sm sm:text-base font-bold truncate",children:e.title}),t.jsxs("div",{className:"mt-1 flex justify-between items-center",children:[t.jsx("p",{className:"text-slate-300 text-xs sm:text-sm",children:e.year}),e.imdbRating&&e.imdbRating>0?t.jsxs("div",{className:"flex items-center gap-1.5",title:`IMDb Rating: ${e.imdbRating}/10`,children:[t.jsx("span",{className:"bg-yellow-500 text-black text-xs sm:text-sm font-bold px-2 py-0.5 rounded-sm",children:"IMDb"}),t.jsx("span",{className:"font-bold text-white text-sm",children:e.imdbRating.toFixed(1)})]}):t.jsx("div",{className:"h-5"})]})]})]})})},k=f.memo(w);export{k as S,S as a,L as u};
