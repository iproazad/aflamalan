import{u as L,r as a,j as e,s as j}from"./index-DwgRMzof.js";const k=()=>{const{currentUser:t,refreshUser:N}=L(),[l,n]=a.useState(""),[r,d]=a.useState(""),[c,h]=a.useState(!1),[u,i]=a.useState(""),[g,m]=a.useState(""),[v,U]=a.useState(!1),[p,b]=a.useState(!1),[y,f]=a.useState(""),[w,x]=a.useState("");if(a.useEffect(()=>{t&&(n(t.displayName||""),d(t.photoURL||""))},[t]),a.useEffect(()=>{if(!t)return;const s=l!==(t.displayName||""),o=r!==(t.photoURL||"");U(s||o)},[l,r,t]),!t)return e.jsx("p",{children:"Please log in to view your profile."});const E=()=>{if(r)return r;const s=l||t.email||"A";return`https://ui-avatars.com/api/?name=${encodeURIComponent(s)}&background=161B22&color=E6EDF3&bold=true`},P=()=>{t&&(n(t.displayName||""),d(t.photoURL||"")),m(""),i("")},R=async s=>{s.preventDefault(),h(!0),m(""),i("");try{const{error:o}=await j.auth.updateUser({data:{full_name:l.trim(),avatar_url:r.trim()}});if(o)throw o;await N(),i("تم تحديث الملف الشخصي بنجاح!")}catch(o){m("فشل تحديث الملف الشخصي. يرجى المحاولة مرة أخرى."),console.error("Profile Update Error:",o)}finally{h(!1)}},S=async()=>{if(!t.email){x("لا يوجد عنوان بريد إلكتروني مرتبط بهذا الحساب.");return}b(!0),f(""),x("");try{const{error:s}=await j.auth.resetPasswordForEmail(t.email,{redirectTo:window.location.origin});if(s)throw s;f("تم إرسال رابط إعادة تعيين كلمة المرور إلى بريدك الإلكتروني. يرجى التحقق من صندوق الوارد الخاص بك.")}catch(s){x("فشل في إرسال البريد الإلكتروني لإعادة تعيين كلمة المرور. يرجى المحاولة مرة أخرى."),console.error("Password Reset Error:",s)}finally{b(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto animate-fade-in",children:[e.jsx("h1",{className:"text-4xl font-black text-white mb-8 border-r-4 border-cyan-400 pr-4",children:"الملف الشخصي"}),e.jsxs("div",{className:"bg-gray-800 p-8 rounded-lg shadow-lg space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-400",children:"البريد الإلكتروني"}),e.jsx("p",{className:"text-xl text-white",children:t.email})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6 border-t border-gray-700 pt-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-400 -mt-2 mb-4",children:"تعديل الملف الشخصي"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx("img",{src:E(),alt:"Profile",className:"w-24 h-24 rounded-full object-cover bg-gray-700 border-2 border-gray-600"}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-300 mb-1",children:"الاسم المعروض"}),e.jsx("input",{type:"text",id:"displayName",value:l,onChange:s=>n(s.target.value),className:"block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"اسمك"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photoURL",className:"block text-sm font-medium text-gray-300 mb-1",children:"رابط صورة الملف الشخصي"}),e.jsx("input",{type:"url",id:"photoURL",value:r,onChange:s=>d(s.target.value),className:"block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"https://example.com/image.png"})]})]})]}),u&&e.jsx("p",{className:"text-green-400 text-sm text-center",children:u}),g&&e.jsx("p",{className:"text-red-400 text-sm text-center",children:g}),v&&e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:P,disabled:c,className:"bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-500 transition-colors disabled:opacity-50",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:c,className:"bg-cyan-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-cyan-600 transition-colors disabled:bg-cyan-800 disabled:cursor-not-allowed",children:c?"جاري الحفظ...":"حفظ التغييرات"})]})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-400 mb-2",children:"تغيير كلمة المرور"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"سنرسل لك بريدًا إلكترونيًا يحتوي على رابط لإعادة تعيين كلمة المرور الخاصة بك."}),e.jsx("button",{onClick:S,disabled:p,className:"bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-500 transition-colors disabled:bg-gray-500/50 disabled:cursor-not-allowed",children:p?"جاري الإرسال...":"إرسال بريد إلكتروني لإعادة التعيين"}),y&&e.jsx("p",{className:"mt-4 text-green-400 text-sm",children:y}),w&&e.jsx("p",{className:"mt-4 text-red-400 text-sm",children:w})]})]})]})};export{k as default};
