import{j as t,u as Y,r as a,f as z}from"./index-DHK5cvRJ.js";import{H as B,a as H}from"./HeroSliderSkeleton-DLHk6CdY.js";import{S as O,G as L,T as Q,Y as I}from"./TagFilter-CcIO8nam.js";import{M as K}from"./MovieGrid-DNh_sAbN.js";import{M as V}from"./MovieGridSkeleton-DB659YRz.js";import{P as W}from"./Pagination-Cb39dPnj.js";import"./useWatchLater-BcOOIyUy.js";import"./MovieCardSkeleton-DdmktY3e.js";const q=({searchQuery:n,onSearchChange:u})=>t.jsxs("div",{className:"relative w-full md:w-auto md:flex-grow",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",value:n,onChange:x=>u(x.target.value),placeholder:"ابحث عن فيلم...",className:"w-full bg-gray-700 text-white p-2 pl-10 rounded-md focus:ring-2 focus:ring-cyan-500 border-none outline-none","aria-label":"Search for movies by title"})]}),j=28,re=()=>{const{kurdishMovies:n,categories:u,loading:x}=Y(),[l,T]=a.useState("all"),[o,p]=a.useState([]),[i,y]=a.useState([]),[c,A]=a.useState("createdAt_desc"),[d,M]=a.useState(""),[h,w]=a.useState(1),D=e=>{p(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},G=()=>{p([])},C=e=>{y(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},_=()=>{y([])},P=a.useMemo(()=>[...new Set(n.map(e=>e.year))].sort((e,s)=>s-e),[n]),k=u,F=a.useMemo(()=>[...new Set(n.flatMap(e=>e.tags||[]))].sort(),[n]),f=a.useMemo(()=>n.filter(e=>l==="all"||e.year.toString()===l).filter(e=>o.length===0?!0:o.some(s=>{var r;return(r=e.genres)==null?void 0:r.includes(s)})).filter(e=>i.length===0?!0:i.some(s=>{var r;return(r=e.tags)==null?void 0:r.includes(s)})).filter(e=>z(d,e.title)).sort((e,s)=>{var r,S,b,v;switch(c){case"rating_desc":return Number(s.imdbRating||0)-Number(e.imdbRating||0);case"rating_asc":return Number(e.imdbRating||0)-Number(s.imdbRating||0);case"year_desc":return s.year-e.year;case"year_asc":return e.year-s.year;case"createdAt_asc":{const m=(r=e.createdAt)!=null&&r.toDate?e.createdAt.toDate().getTime():new Date(e.createdAt).getTime(),g=(S=s.createdAt)!=null&&S.toDate?s.createdAt.toDate().getTime():new Date(s.createdAt).getTime();return(isNaN(m)?0:m)-(isNaN(g)?0:g)}case"createdAt_desc":default:{const m=(b=e.createdAt)!=null&&b.toDate?e.createdAt.toDate().getTime():new Date(e.createdAt).getTime(),g=(v=s.createdAt)!=null&&v.toDate?s.createdAt.toDate().getTime():new Date(s.createdAt).getTime();return(isNaN(g)?0:g)-(isNaN(m)?0:m)}}}),[n,l,o,i,d,c]);a.useEffect(()=>{w(1)},[l,o,i,d,c]);const N=Math.ceil(f.length/j),E=f.slice((h-1)*j,h*j),R=d!==""||l!=="all"||o.length>0||i.length>0||c!=="createdAt_desc";return x?t.jsxs("div",{children:[t.jsx(B,{}),t.jsx("div",{className:"my-8 h-20 bg-gray-800/50 rounded-lg animate-pulse"}),t.jsxs("section",{className:"mb-12",children:[t.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-6 border-r-4 border-cyan-400 pr-4",children:"الأفلام المدبلجة للكردية"}),t.jsx(V,{count:18})]})]}):t.jsxs("div",{className:"animate-fade-in",children:[t.jsx(H,{movies:n.slice(0,5)}),t.jsxs("div",{className:"relative z-30 my-8 flex flex-col md:flex-row justify-between items-center gap-4 p-4 bg-slate-900/70 backdrop-blur-sm rounded-xl",children:[t.jsx(q,{searchQuery:d,onSearchChange:M}),t.jsxs("div",{className:"w-full md:w-auto flex flex-col md:flex-row md:flex-wrap justify-center items-center gap-4",children:[t.jsx(O,{sortOrder:c,onSortChange:A}),t.jsx(L,{genres:k,selectedGenres:o,onToggleGenre:D,onClearGenres:G}),t.jsx(Q,{tags:F,selectedTags:i,onToggleTag:C,onClearTags:_}),t.jsx(I,{years:P,selectedYear:l,onYearChange:T})]})]}),t.jsxs("section",{className:"mb-12",children:[t.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-6 border-r-4 border-cyan-400 pr-4",children:R?"نتائج البحث":"الأفلام المدبلجة للكردية"}),f.length>0?t.jsxs(t.Fragment,{children:[t.jsx(K,{movies:E}),N>1&&t.jsx(W,{currentPage:h,totalPages:N,onPageChange:w})]}):t.jsx("div",{className:"text-center p-8 bg-gray-800 rounded-lg mt-8",children:t.jsx("p",{className:"text-xl text-gray-400",children:"لا توجد أفلام مدبلجة للكردية تطابق معايير البحث."})})]})]})};export{re as default};
