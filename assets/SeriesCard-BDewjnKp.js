import{u as m,r as i,d as h,F as x,R as p,j as t,L as w}from"./index-C75TUr8p.js";const k=()=>{const{currentUser:e}=m(),[a,n]=i.useState([]);i.useEffect(()=>{if(!e){n([]);return}const l=h.collection("user_lists").doc(e.uid).onSnapshot(r=>{if(r.exists){const o=r.data();n((o==null?void 0:o.favoriteSeries)||[])}else n([])},r=>{console.error("Error listening to favorite series:",r)});return()=>l()},[e]);const u=i.useCallback(async s=>{if(!e){console.warn("User must be logged in to manage favorite series.");return}const l=h.collection("user_lists").doc(e.uid),r=a.includes(s);try{r?await l.update({favoriteSeries:x.arrayRemove(s)}):await l.set({favoriteSeries:x.arrayUnion(s)},{merge:!0})}catch(o){console.error("Error toggling favorite series in Firestore:",o)}},[e,a]),c=i.useCallback(s=>a.includes(s),[a]);return{favoriteSeries:a,toggleFavoriteSeries:u,isFavoriteSeries:c}},N=()=>{const{currentUser:e}=m(),[a,n]=i.useState([]);i.useEffect(()=>{if(!e){n([]);return}const l=h.collection("user_lists").doc(e.uid).onSnapshot(r=>{if(r.exists){const o=r.data();n((o==null?void 0:o.watchLaterSeries)||[])}else n([])},r=>{console.error("Error listening to watch later series list:",r)});return()=>l()},[e]);const u=i.useCallback(async s=>{if(!e){console.warn("User must be logged in to manage watch later list.");return}const l=h.collection("user_lists").doc(e.uid),r=a.includes(s);try{r?await l.update({watchLaterSeries:x.arrayRemove(s)}):await l.set({watchLaterSeries:x.arrayUnion(s)},{merge:!0})}catch(o){console.error("Error toggling watch later series in Firestore:",o)}},[e,a]),c=i.useCallback(s=>a.includes(s),[a]);return{watchLaterSeries:a,toggleWatchLaterSeries:u,isWatchLaterSeries:c}},b=({isFavorite:e})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 sm:h-6 sm:w-6 transition-all duration-300 ${e?"text-red-500":"text-white"}`,fill:e?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 016.364 0L12 7.636l1.318-1.318a4.5 4.5 0 016.364 6.364L12 20.364l-7.682-7.682a4.5 4.5 0 010-6.364z"})}),j=({isWatchLater:e})=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 sm:h-6 sm:w-6 transition-all duration-300 ${e?"text-cyan-400":"text-white"}`,fill:e?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),L=()=>t.jsx("svg",{className:"h-4 w-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),S=({series:e,isFavorite:a,isWatchLater:n,averageRating:u,ratingCount:c,onToggleFavorite:s,onToggleWatchLater:l})=>{const{currentUser:r}=m(),[o,f]=i.useState(!1),g=d=>{d.preventDefault(),d.stopPropagation(),s(e.id)},v=d=>{d.preventDefault(),d.stopPropagation(),l(e.id)};return t.jsx("div",{className:"relative group",children:t.jsxs(w,{to:`/series/${e.id}`,className:"relative block z-10 rounded-lg overflow-hidden shadow-lg hover:shadow-xl hover:shadow-cyan-500/20 transform transition-all duration-300 ease-in-out group-hover:scale-105 bg-slate-800",children:[r&&t.jsxs("div",{className:"absolute top-1.5 right-1.5 z-20 flex flex-col gap-1.5 opacity-0 group-hover:opacity-100 translate-y-2 group-hover:translate-y-0 transition-all duration-300",children:[t.jsx("button",{onClick:g,className:"p-1.5 bg-slate-900/60 rounded-full hover:bg-slate-900/80 transition-all duration-200 hover:scale-110","aria-label":a?"إزالة من المفضلة":"إضافة إلى المفضلة",children:t.jsx(b,{isFavorite:a})}),t.jsx("button",{onClick:v,className:"p-1.5 bg-slate-900/60 rounded-full hover:bg-slate-900/80 transition-all duration-200 hover:scale-110","aria-label":n?"إزالة من قائمة المشاهدة لاحقاً":"إضافة إلى قائمة المشاهدة لاحقاً",children:t.jsx(j,{isWatchLater:n})})]}),t.jsx("div",{className:"relative w-full aspect-[2/3] bg-slate-800 overflow-hidden",children:t.jsx("img",{src:e.posterUrl,loading:"lazy",onLoad:()=>f(!0),alt:e.title,className:`
              w-full h-full object-cover
              transition-all duration-700 ease-in-out group-hover:opacity-75
              ${o?"scale-100 blur-0":"scale-110 blur-md"}
            `})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/70 to-transparent"}),t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 sm:p-3 md:p-4 transition-all duration-300 group-hover:-translate-y-1",children:[t.jsx("h3",{className:"text-white text-sm sm:text-base font-bold truncate",children:e.title}),t.jsxs("div",{className:"mt-1 flex justify-between items-center",children:[t.jsx("p",{className:"text-slate-300 text-xs sm:text-sm",children:e.year}),c>0?t.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-yellow-400",title:`Average rating: ${u.toFixed(1)} from ${c} user${c>1?"s":""}`,children:[t.jsx(L,{}),t.jsx("span",{className:"font-bold text-white",children:u.toFixed(1)}),t.jsxs("span",{className:"text-slate-400 text-xs ml-1 font-normal",children:["(",c,")"]})]}):t.jsx("div",{className:"h-5"})]})]})]})})},C=p.memo(S);export{C as S,N as a,k as u};
